function newCountValue(a,b,c,d){var e=parseInt(a)+b;return isNaN(e)?c?c:0:(c&&c>e&&(e=c),d&&e>d&&(e=d),e)}var ui={};ui.initElems=[],ui.init=function(){var a;for(a=0;a<this.initElems.length;a++)this[this.initElems[a]]()},$(function(){ui.init()}),ui.basket=function(){var a=$(".basket");a.each(function(){var a,b=$(".basket__table",this),c=$(".basket__total-price"),d=$(this).attr("data-currency");$(".basket__table",this).on("click",".delete-btn",function(e){$(this).closest("tr").remove(),a=0,b.find(".basket__sum").each(function(){a+=Number($(this).text().replace(/[^0-9]/g,""))}),c.text(a.toString().replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")+" "+d+"."),e.preventDefault()}).find(".count-input input").on("change.count",function(e){var f=$(this).closest("tr"),g=(Number(f.find(".basket__price").text().replace(/[^0-9]/g,""))*e.value).toString();a=0,isNaN(Number(g))||f.find(".basket__sum").text(g.replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")+" "+d+"."),a=0,b.find(".basket__sum").each(function(){a+=Number($(this).text().replace(/[^0-9]/g,""))}),c.text(a.toString().replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")+" "+d+".")})})},ui.initElems.push("basket"),ui.compare=function(){var a=$(".compare-list td:first-child"),b=$(".compare__titles");if(titleList=$("td",b),compare=$(".compare"),frame=$(".compare__frame"),list=$(".compare-list"),prev=compare.find(".compare__prev"),next=compare.find(".compare__next"),compare.size()&&($(window).load(function(){a.each(function(b){titleList.eq(b).height(a.eq(b).height())}),b.addClass("ready")}),"Sly"in window)){var c=new Sly(frame,{horizontal:1,speed:300,touchDragging:1},{load:function(){list.width()>frame.width()?prev.add(next).show():prev.add(next).hide()}}).init();$(window).resize(function(){c.reload()}),prev.click(function(a){c.slideBy(-253),a.preventDefault()}),next.click(function(a){c.slideBy(253),a.preventDefault()})}$(document).on("click",".compare-list__remove-btn",function(a){var b=$(this).closest("td").index()+1;list.find("td:nth-child("+b+")").remove(),c.reload(),a.preventDefault()})},ui.initElems.push("compare"),ui.footerMap=function(){var a,b=$(".footer-map");b.hover(function(){a=setTimeout(function(){b.addClass("footer-map_active")},1e3)},function(){clearTimeout(a),b.removeClass("footer-map_active")}),b.on("click",".map-popup__close",function(a){$(this).closest(".map-popup").hide(),a.preventDefault()})},ui.initElems.push("footerMap"),ui.gallery=function(){var a=$(".gallery");a.each(function(){function a(a){e.removeClass("gallery__switchers-item_active").eq(a).addClass("gallery__switchers-item_active"),c.removeClass("gallery__item_active").eq(a).addClass("gallery__item_active"),b.css({left:b.offset().left-c.eq(a).offset().left+(d.width()-c.eq(a).width())/2})}var b=$(".gallery__list",this),c=$(".gallery__item",b),d=$(".gallery__frame",this),e=$(".gallery__switchers-item",this),f=0;c.each(function(){f+=$(this).width()}),b.css({width:f,left:b.offset().left-c.eq(0).offset().left+(d.width()-c.eq(0).width())/2}),e.on("click",function(b){var c=$(this);c.hasClass("gallery__switchers-item_active")||a(c.index()),b.preventDefault()}),c.on("click",function(b){var c=$(this);c.hasClass("gallery__item_active")||(a(c.index()),b.preventDefault())})})},ui.initElems.push("gallery"),ui.menuExpand=function(){$(".menu").on("click",".menu__expander",function(){$(this).closest(".menu__title").toggleClass("active")})},ui.initElems.push("menuExpand"),ui.miniCart=function(){var a=$(".mini-cart");a.on("click",".mini-cart__opener",function(){a.toggleClass("mini-cart_active")}),a.on("click",".mini-cart__delete",function(a){$(this).closest(".mini-cart__list-item").remove(),a.preventDefault()}),$(document).on("click",function(b){$(b.target).closest(".mini-cart").size()||$(b.target).is(".mini-cart__delete")||a.removeClass("mini-cart_active")})},ui.initElems.push("miniCart"),ui.productPopupGallery=function(){$(".product-popup__gallery").roundabout({childSelector:"img",minScale:.3})},ui.initElems.push("productPopupGallery"),ui.initShortMenu=function(){var a=$("#short-menu"),b=220,c=$(document.body);a.size()&&$(window).scroll(function(){var a=$(this);a.scrollTop()>=b?c.addClass("short-menu_active"):c.removeClass("short-menu_active")})},ui.initElems.push("initShortMenu"),ui.slider=function(){var a=$(".promo-slider");a.each(function(){function a(a){var j=isNaN(Number(a))?a:e.eq(a),k=isNaN(Number(a))?a.index():a;d.removeClass("promo-slider__item_active").eq(k).addClass("promo-slider__item_active"),e.removeClass("promo-slider__switch-item_active"),j.addClass("promo-slider__switch-item_active"),f.css({left:j.offset().left-j.parent().offset().left}),clearInterval(c),h=0,g.width(0),l||(c=setInterval(b,i))}function b(){if(h+=k,g.css({width:h+"%"}),h>100){var b=e.filter(".promo-slider__switch-item_active");b.next().size()?a(b.index()+1):a(0)}}var c,d=$(".promo-slider__item",this),e=$(".promo-slider__switch-item",this),f=$(".promo-slider__progress",this),g=f.children(),h=0,i=30,j=7e3,k=100*i/j,l=!1;e.on("click",function(b){a($(this)),b.preventDefault()}),$(this).hover(function(){l=!0,clearInterval(c)},function(){c=setInterval(b,i),l=!1}),e.eq(0).trigger("click")})},ui.initElems.push("slider"),ui.filterSelects=function(){function a(a){var b,c,d=$(this);switch(d.addClass("filter-select_active"),"Sly"in window&&(c=d.find(".filter-select__drop-frame"),b=new Sly(c,{scrollBy:45,scrollBar:$("<div class='filter-select__scroll'><div class='filter-select__scroll-btn'></div></div>").appendTo(c),dragHandle:1,minHandleSize:20,dynamicHandle:1,clickBar:0,syncSpeed:.5},{load:function(){c.height()>=c.children().outerHeight(!0)?c.addClass("scroll_disabled"):c.removeClass("scroll_disabled")}}).init()),a){case"search":!function(){var a=[],c=d.find(".filter-select__list"),e="";d.find(".filter-select__list-item").each(function(){var b=$(this);a.push({text:b.text(),value:b.attr("data-value")})}),d.on("oninput"in window?"input":"keyup",".filter-select__search-input",function(){var d,f=this.value.toLowerCase().trimLeft(),g=0,h="";for(f?$(this).parent().addClass("filter-select__input-wrap_active"):$(this).parent().removeClass("filter-select__input-wrap_active");g<a.length;g++)d=a[g].text.toLowerCase().indexOf(f),d>=0&&(h+="<li data-value='"+a[g].value+"' class='filter-select__list-item"+(a[g].value==e?" filter-select__list-item_active":"")+"'>"+a[g].text.substr(0,d)+"<b>"+a[g].text.substr(d,f.length)+"</b>"+a[g].text.slice(d+f.length)+"</li>");c.html(h),b.reload()}).on("click",".filter-select__list-item",function(a){var b=$(this);b.addClass("filter-select__list-item_active").siblings().removeClass("filter-select__list-item_active"),e=b.attr("data-value"),d.trigger({type:"change:filterSelect",value:e,text:b.text(),closeSelect:!0}),a.preventDefault()}).on("keydown:filterSelect",function(a){var c=d.find(".filter-select__list-item_hover"),e=d.find(".filter-select__list-item_active");switch(a.keyCode){case 38:c.size()?c.prev().size()&&(c=c.removeClass("filter-select__list-item_hover").prev().addClass("filter-select__list-item_hover")):c=e.size()?e.prev().size()?e.prev().addClass("filter-select__list-item_hover"):e.addClass("filter-select__list-item_hover"):d.find(".filter-select__list-item:first").addClass("filter-select__list-item_hover"),b.toCenter(c);break;case 40:c.size()?c.next().size()&&(c=c.removeClass("filter-select__list-item_hover").next().addClass("filter-select__list-item_hover")):c=e.size()?e.next().size()?e.next().addClass("filter-select__list-item_hover"):e.addClass("filter-select__list-item_hover"):d.find(".filter-select__list-item:first").addClass("filter-select__list-item_hover"),b.toCenter(c);break;case 13:c.size()&&(c.removeClass("filter-select__list-item_hover"),c.trigger("click"));break;case 27:d.find(".filter-select__opener").trigger("click")}})}();break;case"range":!function(){function a(a,c,e){var f,h;a&&c?(h=a+"-"+c,f=a+" - "+c+" "+b):a?(h=">"+a,f="От "+a+" "+b):c?(f="До "+c+" "+b,h="<"+c):(f=g,h=""),d.trigger({type:"change:filterSelect",value:h,text:f,closeSelect:e})}var b=d.find(".filter-select__currency:first").text(),c=d.find(".filter-select__range-input_from"),e=d.find(".filter-select__range-input_to"),f=d.find(".filter-select__opener"),g=f.text();e.add(c).on("oninput"in window?"input":"keyup",function(){if(this.value.length>12)this.value=this.value.slice(0,12);else{var b=parseInt(this.value);this.value=isNaN(b)?"":b,this.className.indexOf("filter-select__range-input_from")>=0?c.val(this.value):e.val(this.value),a(c.val(),e.val(),!1)}}).change(function(){var b;c.val()&&e.val()&&Number(c.val())>Number(e.val())&&(b=c.val(),c.val(e.val()),e.val(b),a(c.val(),e.val(),!1))}),d.on("change","input.radio",function(){var b,d=$(this);d.prop("checked")&&(this.value.indexOf("-")>=0?(b=this.value.split("-"),c.val(b[0]),e.val(b[1])):(">"==this.value[0]&&(c.val(this.value.slice(1)),e.val("")),"<"==this.value[0]&&(e.val(this.value.slice(1)),c.val(""))),a(c.val(),e.val(),!0))}).on("keydown:filterSelect",function(a){switch(a.keyCode){case 13:case 27:d.find(".filter-select__opener").trigger("click")}})}();break;default:d.on("click",".filter-select__list-item",function(a){var b=$(this);b.addClass("filter-select__list-item_active").siblings().removeClass("filter-select__list-item_active"),d.trigger({type:"change:filterSelect",value:b.attr("data-value"),text:b.text(),closeSelect:!0}),a.preventDefault()}).on("keydown:filterSelect",function(a){var c=d.find(".filter-select__list-item_hover"),e=d.find(".filter-select__list-item_active");switch(a.keyCode){case 38:c.size()?c.prev().size()&&(c=c.removeClass("filter-select__list-item_hover").prev().addClass("filter-select__list-item_hover")):c=e.size()?e.prev().size()?e.prev().addClass("filter-select__list-item_hover"):e.addClass("filter-select__list-item_hover"):d.find(".filter-select__list-item:first").addClass("filter-select__list-item_hover"),b.toCenter(c);break;case 40:c.size()?c.next().size()&&(c=c.removeClass("filter-select__list-item_hover").next().addClass("filter-select__list-item_hover")):c=e.size()?e.next().size()?e.next().addClass("filter-select__list-item_hover"):e.addClass("filter-select__list-item_hover"):d.find(".filter-select__list-item:first").addClass("filter-select__list-item_hover"),b.toCenter(c);break;case 13:c.size()&&(c.removeClass("filter-select__list-item_hover"),c.trigger("click"));break;case 27:d.find(".filter-select__opener").trigger("click")}})}d.removeClass("filter-select_active")}$document=$(document),$(".filter-select").each(function(){$(this);return $(this).find(".filter-select__search").size()?(a.call(this,"search"),!0):$(this).is(".filter-select_range")?(a.call(this,"range"),!0):(a.call(this,"default"),void 0)}).on("change:filterSelect",function(a){a.value?$(this).attr("data-value",a.value).find(".filter-select__opener",this).attr("title",a.text).find("span").text(a.text):$(".filter-select__opener",this).attr("title",a.text).find("span").text(a.text),a.closeSelect&&$(this).removeClass("filter-select_active")}),$document.on("keydown",function(a){[38,40,13,27,32].indexOf(a.keyCode)>=0&&$document.data("activeSelect")&&($document.data("activeSelect").trigger({type:"keydown:filterSelect",keyCode:a.keyCode}),a.preventDefault())}),$document.on("click",".filter-select__opener",function(a){var b=$(this),c=b.closest(".filter-select");c.hasClass("filter-select_active")?($document.data("activeSelect").removeClass("filter-select_active").find(".filter-select__list-item_hover").removeClass("filter-select__list-item_hover"),$.removeData($document,"activeSelect")):($document.data("activeSelect")&&$document.data("activeSelect").removeClass("filter-select_active").find(".filter-select__list-item_hover").removeClass("filter-select__list-item_hover"),$document.data("activeSelect",c.addClass("filter-select_active")),c.find("input:first").focus()),a.preventDefault()}).on("click",function(a){!$(a.target).closest(".filter-select").size()&&$document.data("activeSelect")&&($document.data("activeSelect").removeClass("filter-select_active").find(".filter-select__list-item_hover").removeClass("filter-select__list-item_hover"),$.removeData($document,"activeSelect"))})},ui.initElems.push("filterSelects"),ui.countInput=function(){$(document).on("click",".count-input__more",function(a){var b=$(this).siblings("input"),c=Number(b.attr("data-min")),d=Number(b.attr("data-max"));b.val(newCountValue(b.val(),1,c,d)),b.trigger({type:"change.count",value:b.val()}),a.preventDefault()}),$(document).on("click",".count-input__less",function(a){var b=$(this).siblings("input"),c=Number(b.attr("data-min")),d=Number(b.attr("data-max"));b.val(newCountValue(b.val(),-1,c,d)),b.trigger({type:"change.count",value:b.val()}),a.preventDefault()}),$(document).on("change",".count-input input",function(){var a=$(this),b=Number(a.attr("data-min")),c=Number(a.attr("data-max"));a.val(newCountValue(a.val(),0,b,c)),a.trigger({type:"change.count",value:a.val()})})},ui.initElems.push("countInput"),ui.visualFix=function(){$("#nav .nav__arrow").each(function(){var a=$(this);a.css({"margin-left":a.parent().width()/2-a.width()/2})})},ui.initElems.push("visualFix");